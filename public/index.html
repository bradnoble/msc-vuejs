<!DOCTYPE html>
<html>

<head>
  <title>{{ title }}</title>
  <!--
  <script src="/js/pouchdb-6.3.4.min.js"></script>
  <script src="/js/pouchdb.find.min.js"></script>
  <script src="/js/pouchdb.silverlining.min.js"></script>
  <script>
    var db = new PouchDB('msc');
  </script>
-->
  <script src="vendor/vue/vue.min.js"></script>
  <script src="vendor/vue/vue-resource.min.js"></script>
  <script src="vendor/vue/vue-router.js"></script>
  <!--Import Google Icon Font-->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!--Import materialize.css-->
  <!-- <link type="text/css" rel="stylesheet" href="/css/materialize.min.css" media="screen,projection" /> -->
  <link type="text/css" rel="stylesheet" href="vendor/materialize/css/materialize.min.css" media="screen,projection" />
  <!--MSC specific styles-->
  <link type="text/css" rel="stylesheet" href="css/msc.css" />
  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>

<body>
  <div id="app-container">
  </div>

  <!-- 
    BEGIN TEMPLATES
  -->

  <script type="text/x-template" id="layout-template">
    <div>
      <app-navbar :enabled="true"></app-navbar>
      <div class="container">
        <router-view></router-view>
      </div>
    </div>
  </script>

  <script type="text/x-template" id="navbar-template">
    <div v-show="isEnabled"  class="navbar-fixed">
      <nav>
        <div class="nav-wrapper white black-text">
          <a href="/#" class="brand-logo">
            <span>&nbsp;&nbsp;</span>
            <img src="img/MSC_Logo_60X60.png">
          </a>
          <ul id="nav-mobile" class="right hide-on-med-and-down">
            <router-link :to="{name:'list'}" tag="li">
              <a>Membership List</a>
            </router-link>
            <router-link to="/resources" tag="li">
              <a>Resources</a>
            </router-link>
            <router-link :to="{name:'admin'}" tag="li">
              <a>Admin</a>
            </router-link>
            <router-link to="/logout" tag="li">
              <a>Logout</a>
            </router-link>
            </li>
          </ul>
        </div>
      </nav>
    </div>
  </script>

  <script type="text/x-template" id="footer-template">
  </script>

  <script type="text/x-template" id="login-template">
      <div>
        <h3>
          Welcome
        </h3>
        <div class="row">
          <div class="col m6 s12">
            <p>The Montclair Ski Club, founded in 1947, is a tightly knit group of avid skiers and their families. Amid the fun of skiing, the club promotes a community atmosphere where cooperation and warm personal relationships are valued. On winter weekends at our 40-bed lodge at the base of Mad River Glen, we enjoy skiing, eating and socializing together. Outside of the ski season we also hold various social activities, in both New Jersey and Massachusetts.</p>
            <p>Our 100 active members participate in the running of the club by serving on committees and boards and by helping to maintain the lodge. MSC is a member of the New Jersey Ski Council and encourages its members to participate in its activities.</p>
          </div>
          <div class="col m6 s12">
            <form action="/login" method="post">
              <div>
                  <label>Username:</label>
                  <input type="text" id="username" name="username"/>
              </div>
              <div>
                  <label>Password:</label>
                  <input type="password" name="password"/>
              </div>
              <div>
                  <input type="submit" value="Log In"/>
              </div>
          </form>
        </div>
      </div>
    </script>

  <script type="text/x-template" id="home-template">
    <div>
      <div class="row">
        <div class="col m6 s12">
          <h4>Getting Started</h4>
          <p>Viral engagement blue money, or staff engagement drop-dead date. High turnaround rate ladder up / ladder back to the strategy price point, yet Bob called an all-hands this afternoon, but gain traction, so accountable talk. Message the initiative are there any leftovers in the kitchen? old boys club hammer out old boys club. We need a paradigm shift golden goose. This vendor is incompetent put in in a deck for our standup today let's prioritize the low-hanging fruit and shotgun approach not enough bandwidth. Value prop in this space yet we need to start advertising on social media imagineer nail jelly to the hothouse wall where do we stand on the latest client ask, or win-win. On-brand but completeley fresh. We want to see more charts curate helicopter view due diligence. Please use "solutionise" instead of solution ideas! :) quarterly sales are at an all-time low for back of the net, or drink the Kool-aid new economy for new economy. Usabiltiy organic growth Q1, so execute lean into that problem quarterly sales are at an all-time low.</p>
        </div>
        <div class="col m6 s12">
          <h4>News</h4>
          <ul>
              <li>New MSC website launched</li>
              <li>Fall Picnic</li>
              <li>October General Meeting</li>
            </ul> 
        </div>
      </div>
    </div>
  </script>

  <script type="text/x-template" id="view-location">
      <span>
        <!-- <i class="material-icons small">home</i> -->
        <!-- <span v-if="item.label_name"><b>{{ item.label_name}}</b><br /></span> -->
        <span v-if="item.street1">{{ item.street1 }}, </span>
        <span v-if="item.street2">{{ item.street2 }}, </span>
        <span v-if="item.city">{{ item.city }}, </span> 
        <span v-if="item.state">{{ item.state }}, </span> 
        <span v-if="item.zip">{{ item.zip }}</span> 
        <div v-if="item.phone" class=""><i class="material-icons tiny">home</i> {{ item.phone }}</div> 
      </span>
    </script>

  <script type="text/x-template" id="view-person">
      <li class="row collection-item">
        <div class="col m6"><person-name :item="item"></person-name></div>
        <div class="col m6"><person-contact-info :item="item"></person-contact-info></div>
      </li>
    </script>

  <script type="text/x-template" id="view-person-name">
      <span>
        <b>{{ item.last }}, {{ item.first }}</b>
        <span class="person-status grey-text">{{ item.status }}</span>
      </span>
    </script>

  <script type="text/x-template" id="view-person-contact-info">
    <span>
      <div v-if="item.email" class="nowrap"><i class="material-icons tiny grey-text">email</i>&nbsp;{{ item.email }}</div>
      <div v-if="item.phone" class="nowrap"><i class="material-icons tiny grey-text">phone_iphone</i>&nbsp;{{ item.phone }}</div>
      <div v-if="item.work_phone" class="nowrap"><i class="material-icons tiny grey-text">work</i>&nbsp;{{ item.work_phone }}</div>
    </span>
  </script>

  <!-- MEMBERSHIP LIST VIEWS -->

  <!-- parent list view -->
  <script type="text/x-template" id="list">
    <div>
      <router-view @searched="search" :statuses="statuses" :searchstring="searchstring"></router-view>
    </div>
  </script>

  <script type="text/x-template" id="list-intro">
    <div>
      <h5>
        Membership List
      </h5>
      <form action="#" @submit="searchfromchild">
        <div class="input-field">
          <span class="prefix">
            <i class="material-icons" title="search">search</i>
          </span>
          <input id="search" v-model="searchstring" type="text" />
          <label for="search">Search by name</label>
        </div>
      </form>
      <p>
        Search by type:
      </p>
      <div class="row">
        <router-link :to="{name:'faceted-results', params:{ status:status }}" v-for="status in statuses" class="btn col m3 s12 center">
          {{ status }}
        </router-link>
      </div>
      <p>
        Or, <router-link :to="{name:'emails'}">grab email addresses</router-link> to blast email groups of people.
      </p>
    </div>
  </script>

  <!--search results, child of list-->
  <script type="text/x-template" id="results">
  <div>
    <h5>
      <router-link :to="{name: 'list'}">Membership List</router-link> / Search
    </h5>
    <div class="input-field">
      <span class="prefix">
        <i class="material-icons" v-if="searchstring" v-on:click="clearfromchild" title="clear the search input">clear</i>
        <i class="material-icons" v-if="!searchstring" title="search">search</i>
      </span>
      <input id="search" v-model="searchstring" @keyup="searchfromchild" type="text" />
      <label for="search">Search by name</label>
    </div>

    <div class="row">
      <div class="col m3">
        <p>
          Search by type
        </p>
        <div class="collection facets">
          <router-link :to="{name:'faceted-results', params:{ status:'all' }}" class="collection-item" :class="{active: $route.params.status == 'all'}">
            all
            <span class="secondary-content" v-if="$route.params.status == 'all'">
              <i class="material-icons">chevron_right</i>
            </span>
          </router-link>              
          <router-link :to="{name:'faceted-results', params:{ status:status }}" v-if="status != 'deceased'" v-for="status in statuses" class="collection-item" :class="{active: $route.params.status == status}">
            {{ status }}
            <span class="secondary-content" v-if="$route.params.status == status">
              <i class="material-icons">chevron_right</i>
            </span>
          </router-link>
        </div>
      </div>
      <div class="col m9">
        <loading :status="loading"></loading>

        <div v-if="!loading">
          <p v-if="$route.params.status">
            {{ items.length }} {{ $route.params.status }}(s) 

              <a class="dropdown-trigger" href="#" data-target="actions" data-constrainwidth="false" data-alignment="right" title="click to see options">
                <i class="material-icons small">more_horiz</i>
              </a>

              <!-- Dropdown Structure -->
            <ul id="actions" class="dropdown-content">
              <li>
                <a v-bind:href="'/getPeopleForCSV?status=' + $route.params.status">
                  <i class="material-icons">file_download</i> Download (CSV)
                </a>
              </li>
              <li>
                <router-link :to="{name: 'emails', query: {status: $route.params.status }}" v-if="$route.params.status != 'all'">
                  <i class="material-icons">email</i> Get emails for {{ $route.params.status }}(s)
                </router-link>
                <router-link v-else :to="{name: 'emails'}">
                  <i class="material-icons">email</i> Get emails for all
                </router-link>
              </li>
            </ul>

          </p>
          <p v-if="$route.query.q">
            {{ items.length }} result(s) 
          </p>
        </div>

        <ul class="collection" v-if="!loading">
          <li class="collection-item row" v-for="item in items" v-bind:id="item._id">

            <div class="col m5">
              <person-name :item="item"></person-name>
            </div>
            <div class="col m6">
              <person-contact-info :item="item"></person-contact-info>
            </div>
            <div class="col m1">
              <span class="secondary-content" v-if="item.household_id">
                <!-- protected by v-if b/c https://github.com/vuejs/vue-router/issues/986 -->
                <router-link :to="{ name: 'list-household', params: { id: item.household_id } }" title="view household" class="btn btn-flat btn-small waves-effect waves-teal teal-text">
                  <i class="material-icons tiny">home</i>
                </router-link>  
              </span>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>
  </script>

  <!-- second child of list view -->
  <script type="text/x-template" id="emails">
    <div>
      <h6>
        <router-link :to="{name: 'list'}">Membership List</router-link> / Emails
      </h6>      
      <div class="">
          <div class="row">
            <div class="col m3">
              <div class="section">
                <p>
                  Quicklinks
                </p>
                <ul>
                  <li class="">
                    <router-link :to="{query:{status:newsletter}}" :class="{'black-text': JSON.stringify($route.query.status) == JSON.stringify(newsletter)}" :title="newsletter">
                      Newsletter list <i class="material-icons tiny" v-if="JSON.stringify($route.query.status) == JSON.stringify(newsletter)">chevron_right</i>
                    </router-link>                                  
                  </li>
                </ul>
              </div>
              <div class="section">
                <p>
                  Build a list by type
                </p>
                <div class="collection">
                  <a class="collection-item" @click="intercept()" :class="{'active': !$route.query.status}">All</a>
                  <a class="collection-item" v-for="status in statuses" @click="intercept(status)" :class="{active: $route.query.status && $route.query.status.indexOf(status) > -1}">
                    <i class="material-icons tiny" v-if="$route.query.status && $route.query.status.indexOf(status) > -1">check_box</i>
                    <i class="material-icons tiny" v-else>check_box_outline_blank</i> 
                    {{ status }}
                  </a>
                </div>
              </div>
            </div>

            <div class="col m9">
              <p>
                Email addresses
                <!-- <small><a v-on:click="selectEmails()">Select all</a></small> -->
              </p>
              <div v-if="!loading">
                <form>
                  <div class="input-field">
                    <textarea id="textarea-emails" v-model="items" class="materialize-textarea">{{items}}</textarea>
                  </div>
                </form>
              </div>
              <div v-else class="progress">
                <div class="indeterminate"></div>
              </div>

            </div><!-- col -->
          </div><!-- row -->
          <router-link to="/list">Back to the list</router-link>
        </div><!--card panel-->    

    </div>
  </script>

  <script type="text/x-template" id="view-household">
        <div>
          <h6>
            <router-link :to="{name: 'list'}">Membership List</router-link> / {{ item.label_name }}
          </h6>
          <div class="card">
            <div class="card-content">
              <span class="card-title">
                {{ item.label_name }}
              </span>
              <location v-bind:item="item"></location>
              <ul class="collection">
                <person 
                  v-for="person in item.people" 
                  v-bind:key="person._id" 
                  v-bind:item="person">
                </person>
              </ul>
            </div>
          </div>
          <div class="">
            <router-link :to="back">&larr; Back</router-link>
          </div>
        </div>
  </script>

  <!-- ADMIN VIEWS -->

  <script type="text/x-template" id="error">
    <div v-if="error">
      <div class="alert error card">
        <div class="card-content red white-text">
          <p>
            <i class="material-icons">error</i> {{ error }}
          </p>
        </div>      
      </div>
      <div class="card">
        <div class="card-content">
          <span class="card-title">
            Error Details
          </span>
          <p>
            If you are getting this error and you don't know why, copy this stuff and send it to Brad Noble:
          </p>
          <pre>Path: {{ $route.path }}
Parameters:
{{ $route.params }}</pre>
        </div>
      </div>
    </div>
  </script>

  <script type="text/x-template" id="loading">
    <div v-if="status" >
      <div class="progress">
        <div class="indeterminate"></div>
      </div>
    </div>
  </script>

  <script type="text/x-template" id="admin-person">
    <div class="collection-item avatar">
      <i class="material-icons circle green">person</i>
      <span class="title">
        <person-name :item="item"></person-name>
      </span>
      <p>
        <person-contact-info :item="item"></person-contact-info>
      </p>
      <router-link :to="{ name: 'editPerson', params: {household_id: item.household_id, person_id: item._id }}" class="">
        <span class="secondary-content"><i class="material-icons">edit</i></span>
      </router-link>
    </div>
  </script>

  <script type="text/x-template" id="admin">
    <div>
      <h6>
        Admin
      </h6>
      <div v-if="!loading">
        <ul class="collection">
          <li class="collection-item grey lighten-4 row">
            <div class="input-field col m8 s12">
              <i class="material-icons prefix">search</i>
              <input id="search" v-model="searchStr" @keyup="search()" placeholder="First or last name..." />
              <label for="search" class="active">Search for a household</label>
            </div>            
            <div class="col m4">
              <router-link :to="{name:'new-household'}" class="btn right">
                <i class="material-icons">add_location</i> Add household
              </router-link>
            </div>
          </li>
          <li v-for="(item, index) in items" :key="item._id" v-if="!item.hide" class="collection-item">
            <h5>
              {{ item.name }}
              <!-- Dropdown Trigger -->
              <span class="secondary-content">
                <a class="dropdown-trigger" href="#" :data-target="item._id" data-constrainwidth="false" data-alignment="right" title="click to see options">
                  <i class="material-icons small">more_horiz</i>
                </a>
              </span>
              <!-- Dropdown Structure -->
              <ul :id="item._id" class="dropdown-content">
                <li>
                  <router-link :to="{ name: 'newPerson', params: { household_id: item._id }}" title="Add a person to this household">
                    <i class="material-icons">person_add</i> Add a person
                  </router-link>
                </li>
                <li>
                  <router-link :to="{ name: 'editHousehold', params: { household_id: item._id }}" title="Edit household">
                    <i class="material-icons">edit</i> Edit household
                  </router-link>
                </li>
              </ul>
            </h5>
            <div class="row">
              <div class="col m3">
                <location :item="item"></location>
              </div>
              <div class="col m9">
                <ul class="collection">
                    <admin-person 
                    v-for="person in item.people" 
                    v-bind:key="person._id" 
                    v-bind:item="person">
                  </admin-person>
                </ul>
              </div>
            </div><!--row-->
          </li>
        </ul>
      </div>
      <div v-else class="progress">
          <div class="indeterminate"></div>
      </div>
    </div>
  </script>

  <script type="text/x-template" id="form-errors">
    <div v-if="errors.length > 0">
      <ul class="errors">
        <li v-for="error in errors" class="red-text text-darken-2">
          <i class="material-icons red-text text-darken-2">error</i> {{ error }}
        </li>
      </ul>
    </div>
  </script>

  <!-- a list of people in the household -->
  <script type="text/x-template" id="first-child">
    <div>
      <ul class="collection" v-show="item.people.length > 0">
        <admin-person 
          v-for="person in item.people" 
          v-bind:key="person._id" 
          v-bind:item="person">
        </admin-person>                
      </ul>
      <p v-if="item.people.length == 0">
        <router-link :to="{ name: 'newPerson', params: { household_id: item._id }}" class="btn">
          <i class="material-icons">person_add</i> Add a person
        </router-link>
      </p>
    </div>
  </script>

  <!-- a form to edit a person in the household -->
  <script type="text/x-template" id="second-child">
    <div>

        <form id="form-edit-person" name="form-edit-person" v-on:submit="save" action="#" method="post">
          <div class="card-content blue lighten-5">
      
            <span class="card-title">{{ title.content }}</span>

            <form-errors :errors="errors"></form-errors>

            <div class="row">
              <div class="input-field col m6 s12">              
                <input type="text" id="item_first" v-model="person.first" type="text" class="validate" />
                <label for="item_first" class="active">First name</label>
                <span class="helper-text red-text text-darken-2">Required</span>
              </div>
              <div class="input-field col m6 s12">              
                <input type="text" id="item_last" v-model="person.last" type="text" class="validate" />
                <label for="item_last" class="active">Last name</label>
                <span class="helper-text red-text text-darken-2">Required</span>
              </div>
            </div>
            <div class="row">
              <div class="input-field col m12 s12">              
                <input type="text" id="item_email" v-model="person.email" type="email" class="validate"  />
                <label for="item_email" class="active">Email</label>
              </div>
            </div>
            <div class="row">
              <div class="input-field col s6">              
                <input type="text" id="item_phone" v-model="person.phone" type="text" class="validate" />
                <label for="item_phone" class="active">Mobile phone</label>
              </div>
              <div class="input-field col s6">              
                <input type="text" id="item_work_phone" v-model="person.work_phone" type="text" class="validate" />
                <label for="item_work_phone" class="active">Work phone</label>
              </div>
            </div>
            <div class="row">
              <div class="col m6 s12">              
                <p>
                  Membership status
                </p>
                <p v-for="(value, idx) in statuses">
                  <label v-bind:for="person._id + '-' + idx">
                    <input 
                      type="radio" 
                      :name="person._id + '-' + idx" 
                      :id="person._id + '-' + idx" 
                      :value="value" 
                      v-model="person.status" 
                      class="with-gap"
                    />
                    <span>{{ value }}</span>
                  </label>
                </p>                
              </div>
              <div class="col m6 s12">              
                <p>Gender</p>
                <p v-for="(value, index) in genders">
                  <label :for="person._id + '-gender-' + index">
                    <input type="radio" 
                      :name="person._id + '-gender-' + index" 
                      :id="person._id + '-gender-' + index" 
                      :value="value" 
                      v-model="person.gender" 
                      class="with-gap"
                    />
                    <span>{{ value }}</span>
                  </label>
                </p>                
              </div>
            </div><!-- row -->    

          </div><!--card-content-->
          <div v-if="$route.name != 'newPerson'" class="card-content red lighten-4">
            <p>
              <label v-on:click="removePerson()" class="red-text text-darken-2">
                <input type="checkbox" v-bind:id="person._id" v-model="person._deleted" />
                <span>Remove this person</span>
              </label>
            </p>
            <p>
              Only remove someone who has been added in error. This can not be undone.
            </p>
          </div><!-- card-content -->

          <div class="card-action grey lighten-4">
            <input type="hidden" v-model="person.household_id"  />
            <button id="save" class="btn btn-large waves-effect waves-light" type="submit">Submit</button>
            <router-link :to="{name: 'admin-household', params: {household_id: person.household_id}}" class="waves-effect waves-light btn-flat grey-text" title="cancel changes, and return to the list">Cancel</router-link>
          </div>

        </form>

    </div>
  </script>

  <!-- a form to edit a household -->
  <script type="text/x-template" id="third-child">
    <div>

      <form id="form-edit-household" name="form-edit-household" v-on:submit="save" action="#" method="post">

        <div class="card-content grey lighten-4">
          <span class="card-title">{{ title.content }}</span>

          <form-errors :errors="errors"></form-errors>

          <div class="row">
            <div class="input-field col m4 s12">
              <input type="text" id="household_name" v-model="item.name" class="validate" />
              <label for="household_name" class="active">Household name</label>
              <span class="helper-text red-text text-darken-2">Required</span>
            </div>
            <div class="input-field col m8 s12">
              <input type="text" id="household_label_name" v-model="item.label_name"  />
              <label for="household_label_name" class="active">Mailing label name</label>
            </div>
          </div>
          <div class="row">
            <div class="input-field col m8 s12">
              <input type="text" id="household_street1" v-model="item.street1"  />
              <label for="household_street1" class="active">Street 1</label>
            </div>
            <div class="input-field col m4 s12">
              <input type="text" id="household_street2" v-model="item.street2"  />
              <label for="household_street2" class="active">Street 2</label>
            </div>
          </div>
          <div class="row">
            <div class="input-field col m6 s12">
              <input type="text" id="household_city" v-model="item.city"  />
              <label for="household_city" class="active">City</label>
              <span class="helper-text red-text text-darken-2">Required</span>
            </div>
            <div class="input-field col m2 s12">
              <input type="text" id="household_state" v-model="item.state"  />
              <label for="household_state" class="active">State</label>
              <span class="helper-text red-text text-darken-2">Required</span>
            </div>
            <div class="input-field col m4 s12">
              <input type="text" id="household_zip" v-model="item.zip"  />
              <label for="household_zip" class="active">ZIP</label>
              <span class="helper-text red-text text-darken-2">Required</span>
            </div>
          </div>

          <div class="input-field">              
            <input type="text" id="household_phone" v-model="item.phone"  />
            <label for="household_phone" class="active">Household Phone</label>
          </div>

          <div class="section">
            <h5>
              Hardcopies
            </h5>
          </div>

          <div class="row">              
            <div class="col m6 s12 switch">
              Mail a hardcopy of the newsletter?<br />
              <label>
                No
                <input type="checkbox" id="mail_news" v-model="item.mail_news">
                <span class="lever"></span>
                Yes
              </label>
            </div>
            <div class="col m6 s12 switch">
              Mail a hardcopy of the membership list?<br />
              <label>
                No
                <input type="checkbox" id="mail_list" v-model="item.mail_list">
                <span class="lever"></span>
                Yes
              </label>
            </div>
          </div><!--row-->

        </div><!--card content-->
        <div class="card-content red lighten-4" v-if="$route.params.household_id">
          <p>
            <label  class="red-text text-darken-2">
              <input type="checkbox" v-model="item._deleted" />
              <span>Remove this household</span>
            </label>
          </p>
          <p>
            Only remove households that have been added in error. Deleting the household deletes the people in the household, too. This can not be undone.
          </p>
        </div><!-- card-content -->
        <div class="card-action grey lighten-4">
          <input type="hidden" v-model="item.household_id"  />
          <button id="save" class="btn btn-large waves-effect waves-light" type="submit" name="action">Submit</button>
          <router-link v-if="$route.name == 'editHousehold'" :to="{name: 'admin-household', params: {id: item._id}}" class="waves-effect waves-light btn-flat grey-text" title="cancel changes, and return to the list">Cancel</router-link>
          <router-link v-if="$route.name == 'new-household'" :to="{name: 'admin'}" class="waves-effect waves-light btn-flat grey-text" title="cancel changes, and return to the list">Cancel</router-link>
        </div>

      </form>

    </div>
  </script>

  <!-- a form to add a new household -->
  <script type="text/x-template" id="new-household">
    <div>        
      <h6>
        <a href="#/admin">Admin</a> / Add a household
      </h6>
      <div class="row">
        <div class="col s12 m8">
          <div class="card">
            <div class="card-content">
              <span class="card-title">
                Add household
              </span>
              <router-view :item="item"></router-view>
            </div><!--card-content-->
          </div><!--card-->
        </div><!--col-->
      </div><!--row-->
    </div>
  </script>

  <!-- parent view for each household -->
  <script type="text/x-template" id="admin-household">
    <div>

      <loading :status="loading"></loading>
      <error :error="error"></error>

      <div v-if="!error">
        <h6>
          <router-link :to="{name: 'admin'}">Admin</router-link> / {{ item.name }}
        </h6>
        <div class="row">
          <div class="col s12 m10">
            <div class="card">
              <div class="card-content">
                <span class="card-title">
                    {{ item.name }}
                    <span v-if="$route.name != 'editPerson' && $route.name != 'newPerson' && $route.name != 'editHousehold'">
                      <!-- Dropdown Trigger -->
                      <span class="secondary-content">
                        <a class="dropdown-trigger" href="#" data-target="dropdown1" data-constrainwidth="false" data-alignment="right" title="click to see options">
                          <i class="material-icons small">more_horiz</i>
                        </a>
                      </span>
                      <!-- Dropdown Structure -->
                      <ul id="dropdown1" class="dropdown-content">
                        <li>
                          <router-link :to="{ name: 'newPerson', params: { household_id: item._id }}" title="Add a person to this household">
                            <i class="material-icons">person_add</i> Add a person
                          </router-link>
                        </li>
                        <li>
                          <router-link :to="{ name: 'editHousehold', params: { household_id: item._id }}" title="Edit household">
                            <i class="material-icons">edit</i> Edit household
                          </router-link>
                        </li>
                      </ul>
                    </span><!-- route guard -->
                </span><!-- card title -->
                <location v-bind:item="item"></location>
    
                <router-view :item="item"></router-view>
              </div>
            </div><!-- card -->
          </div><!-- col -->          
        </div><!--row-->
      </div><!--!error-->
      <a href="#/admin">&larr; Back to Admin</a>
    </div><!-- container -->
  </script>

  <script type="text/x-template" id="logout">
    <span>
      <p>{{ item }}</p>
    </span>
  </script>

  <!--Resources (Google Drive)-->
  <script type="text/x-template" id="resources">
    <div>
      <div class="row">
        <div class="col s12">
        </div>
      </div>
      <div class="row">
        <div class="col s12">
          <h5>Resources&nbsp;<i class="material-icons small cursor-pointer hoverable" @click="onHelp($event)">help_outline</i></h5>
        </div>
      </div>
      <div id="resourcesHelp" class="row">
        <div class="col s12">
            <p>Resources files are organized in folders by topic. PDF files can be viewed and all files can be downloaded.</p>
            <ul>
              <li><i class="material-icons">chevron_right</i>Select a folder to display the files and additional folders contained in it.</li>
              <li><i class="material-icons">chevron_right</i>Select a PDF file to view the contents.</li>
              <li><i class="material-icons">chevron_right</i>Click the <i class="material-icons">file_download</i> icon to download a file.</li>
              <li><i class="material-icons">chevron_right</i>Use the breadcrumbs at the top of the list tomove up in the folder hierarchy.</li>
            </ul>
            <a class="waves-effect waves-light btn blue" @click="onHelp($event)"><i class="material-icons left">arrow_drop_up</i>Close</a>
        </div>
      </div>
            <!-- <div class="row"> -->
        <!-- <div class="col s12">
          <h5>Resources&nbsp;<i class="material-icons small waves-effect waves-light btn modal-trigger" href="resourcesHelpmodal">help_outline</i></h5>
        </div> -->
        <!-- <div class="col s8">
          <nav class="grey lighten-4">
            <div class="nav-wrapper">
              <form>
                <div class="input-field">
                  <input id="search" type="search" placeholder="Search resources"  v-on:keyup.enter="onSearch($event)" required>
                  <label class="label-icon" for="search"><i class="material-icons  black-text">search</i></label>
                  <i class="material-icons">close</i>
                </div>
              </form>
            </div>
          </nav>
        </div> -->
      <!-- </div> -->
      <nav class="blue darken-2">
        <div class="nav-wrapper">
          <div class="col s12">
            <span v-for="folder in path" @click="onBreadcrumb(folder.id, $event)" class="breadcrumb cursor-pointer">{{folder.name}}</span>
          </div>
        </div>
      </nav>
      <div class="row">
        <div class="col s12">
          <div class="divider"></div>
        </div>
      </div>
      <div v-if="files.length==0">
        <div class="row">
            <div class="col s12"><i class="material-icons small">info_outline</i><span>&nbsp;No files in this folder</span></div>
        </div>
      </div>
      <div v-else>
        <div class="row grey lighten-4">
          <div class="col s5">Name</div>
          <div class="col s1">Type</div>
          <div class="col s2">Modified</div>
          <div class="col s2">Size</div>
          <div class="col s1"></div>
        </div>
        </div>
        <div class="row"  v-for="file in files" :key="file.id" v-if="file.type=='Folder'">
          <div class="col s5" @click="onFolderView(file,$event)"><i class="material-icons small cursor-pointer">folder</i><span class="cursor-pointer">&nbsp;{{file.name}}</span></div>
          <div class="col s1">&minus;</div>
          <div class="col s2">&minus;</div>
          <div class="col s2">&minus;</div>
          <div class="col s1"></div>
        </div>
        <div class="row"  v-for="file in files" :key="file.id" v-if="file.type!='Folder'">
          <div class="col s5" v-bind:class="{'cursor-pointer':file.type=='PDF','hoverable':file.type=='PDF'}" @click="(file.canView?onFileView(file, $event):null)"><i class="material-icons small">{{(file.type=='PDF'?'description':(file.type=='Spreadsheet'?'grid_on':'format_align_left'))}}</i><span>&nbsp;{{file.name + (!file.canView?'&nbsp;(Download only)':'')}}</span></div>
          <div class="col s1">{{file.type}}</div>
          <div class="col s2">{{file.modifiedTimeFormatted}}</div>
          <div class="col s2" v-html="file.sizeFormatted"></div>
          <div class="col s1"><i v-if="file.canDownload" class="material-icons small cursor-pointer hoverable" @click="onFileDownload(file, $event)">file_download</i></div>
        </div>
      </div>
    </div>
  </script>

  <!--Resources: PDF viewer for Google Docs-->
  <div id="pdfModal" class="modal">
    <iframe id="pdfViewer" name="pdfViewer" src="vendor/pdfjs/web/viewer.html" allowfullscreen="true" webkitallowfullscreen=""></iframe>
  </div>

  <!--Import jQuery before materialize.js-->
  <script type="text/javascript" src="vendor/jquery/jquery.min.js"></script>
  <!-- <script type="text/javascript" src="/js/materialize.min.js"></script> -->
  <script type="text/javascript" src="vendor/materialize/js/materialize.min.js"></script>
  <!--PDF viewer for Resources-->
  <script type="text/javascript" src="vendor/pdfjs/build/pdf.js"></script>
  <script type="text/javascript" src="vendor/pdfjs/web/viewer.js"></script>
  <!--MSC-->
  <script type="text/javascript" src="factories.js"></script>
  <script type="text/javascript" src="routes.js"></script>
  <script type="text/javascript" src="main.js"></script>
</body>

</html>